#set( $moduleid = $context.findValue("module") )

<div id="permissionedit" class="ui-widget">
	<div class="ui-widget-header"><span class="widget-header-title">Permissions Editor - $data</span></div>
	<div class="ui-widget-content" style="padding-top: 20px; ">

<p>$permdata.name - $!permdata.caption</p>
<br>
	<label><b>[[Allow:]]</b></label>

<form method="post" name="permissiontype"  class="ajaxform" data-targetdiv="permissionedit" action="$home$apphome/views/modules/${moduleid}/datapermissions/addgroup.html">
	<input type="hidden" name="datapermission.value" value="${permdata.id}"/>
	<input type="hidden" name="moduleid.value" value="${permdata.moduleid}"/>
	<input type="hidden" name="parentfolderid.value" value="${data.id}"/>
	<input type="hidden" name="dataid.value" value="${data.id}"/>
	
	<input type="hidden" name="field" value="datapermission" />
	<input type="hidden" name="field" value="moduleid" />
	<input type="hidden" name="field" value="parentfolderid" />
	<input type="hidden" name="field" value="dataid" />
	
	<input type="hidden" name="permissionid" value="${permdata.id}"/>
	<input type="hidden" name="dataid" value="${data.id}"/>
	<input type="hidden" name="currentpermission" value="$!permission.id"/>
	
	
	
	<select name="addgroup" class="form-control" style="width:200px; margin-right:5px; float:left;">
		<option value=""></option>
		<option value="true">Anyone</option>
		<option value="false">Nobody</option>
		<option value="xml">Custom Xml</option>
		<option value="">Groups</option>
#foreach( $group in $allgroups )
		<option value="group.$group.id">&nbsp;&nbsp;&nbsp;&nbsp;$group.name</options>
#end
#set( $settingsgroups = $searcherManager.getList($catalogid,"settingsgroup"))	
#if( $settingsgroups.size() > 0)
		<option value="">User Profile</option>
#foreach( $settings in $settingsgroups )
		<option value="settingsgroup.$settings.id">&nbsp;&nbsp;&nbsp;&nbsp;$settings.name</options>
#end
#end	
<!-- 		<option value="">Security Group Property</option>  -->

	</select>	
	<input class="btn btn-sm btn-primary" type="submit" value="[[Add]]" />
	
</form>
<div class="clearfix"></div>
<div class="edit-permissions">
#if( $issimple == "true" )

<div id="editsimple" style="padding:20px 0" >
<p><b>[[Allowed Groups]]:</b></p>
<div style="padding: 5px 10px;">
#if( $selgroups.size() > 0 )	
	<table class="table table-striped">
	#set( $count = 0 )
	#foreach( $group in $selgroups )
		<tr>
		<td>$group</td><td> <a class="ajax" targetdiv="permissionedit" href="$home$apphome/views/modules/${moduleid}/datapermissions/removegroup.html?traverse=0/$count&id=$permission.id"><img src="$home/system/images/toolbar/deletefile.gif" /></a></td>
		#set( $count = $count + 1 )
		</tr>
	#end
	</table>
#else
	#if( !$permission || $permission.toString() == "false" )
		Nobody
	#elseif( $permission.toString() == "true" || $permission.toString() == "" )
		[[Anyone]]
	#else
		Custom: $permission
	#end
#end
</div>

</div>
#else
$pages.include("$apphome/views/modules/${moduleid}/datapermissions/xml/edit.html?id=${permissionid}")
#end

</div>

<a class="ajax btn btn-sm btn-secondary"  targetdiv="permissionedit" href="$home$apphome/views/modules/${moduleid}/datapermissions/reset.html?id=$permission.id">Reset to defaults</a>

</div>

	


</div>