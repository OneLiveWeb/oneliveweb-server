#set( $leftbarstatus = $userprofile.get("leftbarstatus"))
#set( $filtersbarstatus = $userprofile.get("filtersbarstatus"))

#if( !$hits )
	#set( $hits = $collectionassets)
	$context.putPageValue("hits",$hits)
#end

#if( !$hits )
	#set( $hits = $orderassets)
	$context.putPageValue("hits",$hits)
#end
 
#if($hits)
	#set( $collectionid = $hits.getInput("collectionid") )
	#if( $collectionid && !$librarycol)
	
		#set( $librarycol = $mediaarchive.getData("librarycollection",$collectionid) )
		$context.putPageValue("librarycol",$librarycol)
	#end
	#set( $caneditdata = $hits.getSearchQuery().getValue("caneditdata") )
	#if( $caneditdata )
		$context.putPageValue("caneditdata",$caneditdata)
	#end
	#set( $catid = $hits.getInput("categoryid") )
	
	#set( $nodeID = $context.getRequestParameter("nodeID"))
	#if (!$catid && $nodeID)
		#set( $catid = $nodeID )
	#end
	$context.putPageValue("catid",$catid)
	#if( $catid && !$category)
		
		#set( $category = $mediaarchive.getData("category",$catid) )
	#end
	#set( $orderid = $hits.getInput("orderid") )
	#if( $orderid)
		#set( $order = $mediaarchive.getData("order",$orderid) )
		$context.putPageValue("order",$order)
	#end
#end


<div id="resultsheader">
<div id="sub-nav" class="emsubnav">
	<ul class="resultsnav">
		#set ($enabled=$hits.getSelectionSize() > 0)
		#if( $librarycol )
			$pages.include("$apphome/components/desktop/menu.html?collectionid=$librarycol.getId()",$context)				
			#end
		<li>
			<a class="nav-btn lefttoggle #if ($leftbarstatus!=false) hide #end" href="#" id="lefttoggle">
			<span class="openbar "><i class="fas fa-folder-open"></i> [[CATEGORIES]]</a></span>
		</li>
		
		  	
		$pages.include("$apphome/components/results/selected/index.html",$context)

	
		#if( $enabled && ($canpublish || $canemaillink || $canexportdata ) )
		  <li class="nav-item dropdown">
			<a class="nav-link dropdown-toggle" href="#" id="navbarSharehDropdown" role="button" data-toggle="dropdown" 
				aria-haspopup="true" aria-expanded="false">[[Share]]</a>
				<div class="dropdown-menu" aria-labelledby="navbarShareDropdown">
			#if($canpublish || $canemaillink )				
					#if( $canemaillink )
						<a class="dropdown-item emdialog" data-hidefooter="true" href="$home$apphome/views/activity/emailassets.html?hitssessionid=$!hits.getSessionId()" >[[Email Assets]]</a>
					#end
					#if( $canpublish)
						<a  class="dropdown-item emdialog" data-hidefooter="true" href="$home$apphome/views/activity/publishassets.html?hitssessionid=$!hits.getSessionId()" >[[Publish Assets to Server]]</a>
					#end
					#if( $canquickgallery)
						<a  class="dropdown-item emdialog" data-hidefooter="true" href="$home$apphome/views/activity/creategallerycollection.html?hitssessionid=$!hits.getSessionId()" >[[Create a shareable gallery]]</a>
					#end
			#end
			#if($canexportdata)
				<a class="dropdown-item" href="$home$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&searchtype=asset">[[Export results]]</a>
				<a class="dropdown-item" href="$home$apphome/views/modules/asset/export/download/export_asset.csv?hitssessionid=$hits.sessionId&friendly=true&searchtype=asset&view=asset/resultstable">[[Export results (friendly)]]</a>
			#end		
				</div>
			</li>
		#end
		
		#if($enabled && $canquickpublish )
			#set($quickpublishlist = $mediaarchive.getList("quickpublish"))
		<li class="nav-item">
			<a class="nav-link" href="#" id="navbarPublishDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">[[Publish]]</a>
				<div class="dropdown-menu" aria-labelledby="navbarPublishDropdown">
					#foreach($item in $quickpublishlist)
						<a class="dropdown-item" href="$home$apphome/views/activity/publish/quickpublish.html?hitssessionid=$!hits.getSessionId()&quickid=$item.id"   >$item.name</a>
					#end
				</div>
			</li>
		#end
		
  		#set( $edit = $context.getRequestParameter("editheader") )
			
		## Already in actions
		## #if ( $canviewbasket )
		##	#if($order)
		##		<li class="nav-item">
		##			<a class="updatebasket" data-action="remove" targetdiv="basket-paint"  href="$home$apphome/components/basket/removeselection.html?hitssessionid=$hits.getSessionId()" ">[[Remove]]</a>
		##		</li>
		##	#end
		## #end
		
		
		#if ( $canviewbasket )
			#if($order)
				<li ><a class="updatebasket emdialog nav-link-cart" data-action="remove" targetdiv="basket-paint"  href="$home$apphome/views/activity/checkout/accept.html?orderid=${order.id}" title="[[Checkout your Cart]]">[[Checkout Cart]] <i class="fas fa-caret-right"></i></a></li>				
			#end
		#end
		
		</ul>
		

		
		
		<ul class="resultsnavright">
			<li>
				<a class="nav-btn filterstoggle #if ($filtersbarstatus!=false) hide #end" href="#" id="filterstoggle">
				<span class="openbar"><i class="fas fa-sliders-h"></i> [[FILTERS]]</span> 
				</a>
			</li>
		#set ($resultview = $userprofile.get('resultview'))
		#if (!$resultview || $resultview == 'table')
			#if( $canedittablecolumns )
			#if( $edit )
				<li>
					<a class="ajax table-edit-close" targetdiv="emresultscontent" href="$home$apphome/components/results/table.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader="><i class="fas fa-times"></i></a>
				</li>								
				<li class="resultsnavtitem">
						#set ($alldetails = $searcher.getUserPropertyDetails() )
						<select  class="form-control" onchange='return addColumn(jQuery(this).val())' name="addcolumn" >
							<option>[[Add Column]]</option>
							#foreach( $detail in $alldetails) <option value="$detail.id">$detail.getText($context)</option>
							#end
						</select>
						<script type="text/javascript">
							function addColumn(inId) {
								jQuery('#emresultscontent').load("$home$apphome/components/results/addremovecolumns.html?oemaxlevel=1&searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true&addcolumn=" + inId);
								return false;	
							}
						</script>
				</li>	
			#else 
				<li >
					<a class="ajax" id="table-editor" targetdiv="emresultscontent" href="$home$apphome/components/results/table.html?searchtype=asset&hitssessionid=$hits.getSessionId()&editheader=true"> <i class="fas fa-edit"></i></a>
				</li>
			#end	
			#end								
		#end
		#if($edit && $edit == "true"  )
			<li class="resultsnavtitem">
					<span class="small" style="padding-right: 10px;" >[[Drag columns to move them]]</span>
			</li>
		#end		
		#if(!$resultview)
			#set($resultview = $userprofile.get("resultview"))
			#if (!$resultview)
				#set($resultview = "table")
			#end
		#end
		#if(!$edit || $edit == "false"  )
			<li class="resultsnavtitem">
				<select class="form-control" name="resultview" id="selectresultview" class="smalldropdown" 
					data-hitssessionid="$hits.getSessionId()" data-searchtype="asset" data-page="$hits.getPage()" data-showremoveselections="$showremoveselections" data-collectionid="$!librarycol.getId()">
				#set( $types = $mediaarchive.getList("resulttype"))
				#foreach($type in $types)
					<option value="$type.getId()" #if( $resultview == "$type.getId()") selected #end>$type.getName($context.locale)</option>
				#end
				</select>
				
			</li>
			#if( $hits && $hits.size() > 0)
				<li class="resultsnavtitem hidden-sm-xs hidden-xs hidden-sm hidden-md">
					$pages.include("$apphome/components/results/pages.html",$context)
				</li>	
				<li class="resultsnavtitem hidden-sm-xs hidden-xs hidden-sm hidden-md">
					<span class="text">[[Results]] $hits.getPageStart() - $hits.getPageEnd() [[of]] $hits.size()</span>
				</li>			
			#end
		#end	


		
		##Filters

		
	</ul>
</div>
</div>
<div class="clearfix"></div>
 