#ifnull($hit)
	#set ($hit = $asset)
#end

#set( $source = $mediaarchive.asLinkToPreview($asset,"video.mp4")) 
#set( $thumb = $mediaarchive.asLinkToPreview($asset,"image640x480.jpg"))

#set( $embed = $context.getRequestParameter("embed") )
#set( $autoplay = $context.getRequestParameter("autoplay") )
#set( $loop = $context.getRequestParameter("loop") )

#set( $mediadbappid = $mediaarchive.getMediaDbId() )
#set( $root = "$!prefix$home$page.directory")
#set( $catalogid = $asset.catalogId )

	<script id="videojs" src="$apphome/components/javascript/videojs/7.2.4/video.js"></script>
	<link href="$apphome/components/javascript/videojs/7.2.4/video-js.css" rel="stylesheet">
##Add back full screen button, Autoplay and escape handling
<div id="playarea-$hit.id" class="player">
	<video id="video-$hit.id" class="video-js vjs-default-skin vjs-big-play-centered" style="position: relative;width: 100%!important; height: 100%!important;"
		poster='$thumb'
		#if( $loop && $loop == "true") loop #end
		data-setup='{ "controls": true, "autoplay": #if( $autoplay)$autoplay#else false #end, "preload": "auto" }'
		>
		<source type="video/mp4" src="$source">
		#set( $short = $url_util.getPathUtilities().extractPagePath($source) )
		<source type="video/flash" src="mp4:$short">
     	#if( $tracks && !$tracks.isEmpty() )
      		#foreach( $track in $tracks)
     		 <track 
     		 	label="$track.sourcelang subtitles" 
     		 	kind="subtitles" 
     		 	srclang="$track.sourcelang" 
      			src="$!cdn$home/${mediadbappid}/services/module/asset/players/closedcaption/${asset.id}/closedcaption-${track.sourcelang}.vtt"
      		#if( $context.getLanguage() == ${track.sourcelang})	 default #end>
      		#end
      	#end
	</video>
</div>
<script>
var myPlayer = videojs('video-$hit.id');
</script>
